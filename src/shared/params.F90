MODULE PARAMS
  USE, INTRINSIC :: ISO_C_BINDING
  USE, INTRINSIC :: ISO_FORTRAN_ENV, ONLY: INPUT_UNIT, OUTPUT_UNIT, ERROR_UNIT
  IMPLICIT NONE

  INTEGER, PARAMETER :: DWP = KIND(0D0)
  INTEGER, PARAMETER :: QWP = 16

  ! Max file name length.
  INTEGER, PARAMETER :: FNL = 252

  INTEGER(KIND=c_int32_t), PARAMETER :: S_QNAN_MASK = 2143289344_c_int32_t
  INTEGER(KIND=c_int64_t), PARAMETER :: D_QNAN_MASK = 9221120237041090560_c_int64_t

  REAL(KIND=DWP), PARAMETER :: D_ZERO =  0.0_DWP
  REAL(KIND=DWP), PARAMETER :: D_MZERO= -0.0_DWP
  REAL(KIND=DWP), PARAMETER :: D_ONE  =  1.0_DWP
  REAL(KIND=DWP), PARAMETER :: D_MONE = -1.0_DWP

  COMPLEX(KIND=DWP), PARAMETER :: Z_ZERO = (D_ZERO, D_ZERO)
  COMPLEX(KIND=DWP), PARAMETER :: Z_ONE  = (D_ONE , D_ZERO)

  REAL(KIND=DWP), PARAMETER :: TWOF = SQRT(HUGE(D_ZERO))
  REAL(KIND=DWP), PARAMETER :: MINF = REAL(Z'0000000000000001',DWP)

  INTERFACE QUIET_NAN
     MODULE PROCEDURE S_QUIET_NAN
     MODULE PROCEDURE D_QUIET_NAN
  END INTERFACE QUIET_NAN

CONTAINS

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

  PURE FUNCTION S_QUIET_NAN(PAYLOAD)
    IMPLICIT NONE
    INTEGER(KIND=c_int), INTENT(IN) :: PAYLOAD
    REAL(KIND=c_float) :: S_QUIET_NAN
    S_QUIET_NAN = TRANSFER(IOR(PAYLOAD, S_QNAN_MASK), 0.0_c_float)
  END FUNCTION S_QUIET_NAN

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

  PURE FUNCTION D_QUIET_NAN(PAYLOAD)
    IMPLICIT NONE
    INTEGER(KIND=c_int64_t), INTENT(IN) :: PAYLOAD
    REAL(KIND=c_double) :: D_QUIET_NAN
    D_QUIET_NAN = TRANSFER(IOR(PAYLOAD, D_QNAN_MASK), 0.0_c_double)
  END FUNCTION D_QUIET_NAN

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

END MODULE PARAMS
